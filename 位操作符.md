# 位操作符

## ECMAScript中的数值储存方式

### ECMAScript中的所有数值都以IEEE 754 64位存储，但进行位操作时，先把值转换为32位整数，再进行位操作，之后再把结果转换为64位。

- 这个转换过程对于开发者是不可见的，所以就像只有32位一样。
- 这个过程也会导致一些问题。

	- NaN会被当成0处理。
	- Infinity会被当成0处理。

## 整数

### 有符号整数

- 有符号整数使用32位的前31位表示数值，第32位表示数值的符号。

	- 正值以真正的二进制格式存储。

		- 如果一个位是空的，那么会自动用0填充。

			- 一个例子是，数值18的二进制格式是10010。

	- 负值以补码的二进制格式存储。

		- 计算负值的二进制编码有3步

			- 确定负值的绝对值的二进制表示。（如-18找到18的二进制表示）。
			- 为这个二进制编码找补数。（把每个0变为1，每个1变为0，包括符号位）。
			- 给得到的二进制编码加1。

### 无符号整数

- 在默认情况下，ECMAScript中的所有数值都是有符号整数。

## 位操作

### ECMAScript中一共有7种位操作。

- 按位非

	- 按位非操作符用 ~ 表示，它的作用是返回数值的补数。

		- 最终结果是对数值取负值并减1。

- 按位与

	- 按位与操作符用 & 表示，它有2个操作数。

		- 实际上，它是把两个操作数的每一位对齐，并做与操作。

			- 按位与在2个位上都是1时，返回1，在有1位上是0时，返回0。

- 按位或

	- 按位或操作符用 | 表示，它有2个操作数。

		- 实际上，它把2个操作数的每一位对齐，并做或操作。

			- 按位或在至少有1位是1时，返回1，在2位都是0时，返回0。

- 按位异或

	- 按位异或操作符用^表示，它有2个操作数。

		- 按位异或只在1位上是1时，返回1。

- 左移

	- 左移操作符用<<表示

		- 左移会把操作数的所有位向左移指定位。

			- 左移不会改变第32位符号位。

- 有符号右移

	- 有符号右移操作符用>>表示。

		- 有符号右移会将整个31位（除符号位）右移指定位。

			- 有符号右移是左移的逆操作。

- 无符号右移

	- 无符号右移操作符用 >>> 表示。

		- 无符号右移对于正数来说和有符号右移没有什么区别。
		- 无符号右移对于负数来说，会把所有32位右移指定位数，并且注意在内存中负数是以补码的形式存放的，所以负数做无符号右移之后会变成正数且非常大。

*XMind: ZEN - Trial Version*